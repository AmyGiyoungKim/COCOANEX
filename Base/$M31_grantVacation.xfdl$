<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.1">
  <Form id="M32_grantVacation" width="1090" height="650" titletext="New Form" onload="M31_grantVacation_onload">
    <Layouts>
      <Layout height="650" width="1090">
        <Static id="Static00" taborder="1" text="휴가 사용처리" left="0" top="0" height="34" cssclass="sta_WF_title01" right="10" font="bold 18px/normal &quot;Malgun gothic&quot;,&quot;Arial&quot;,&quot;Gulim&quot;"/>
        <Div id="Div00" taborder="0" text="Div00" left="10" top="100" right="660" minwidth="380" maxwidth="" bottom="50" minheight="470" maxheight="">
          <Layouts>
            <Layout>
              <Grid id="Grid00" taborder="0" left="0" top="0.00%" binddataset="ds_document" autofittype="col" right="0" bottom="0">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="61"/>
                      <Column size="129"/>
                      <Column size="93"/>
                      <Column size="51"/>
                    </Columns>
                    <Rows>
                      <Row size="35" band="head"/>
                      <Row size="30"/>
                    </Rows>
                    <Band id="head">
                      <Cell text="문서번호"/>
                      <Cell col="1" text="제목"/>
                      <Cell col="2" text="승인날짜" autosizecol="default"/>
                      <Cell col="3" text="처리여부"/>
                    </Band>
                    <Band id="body">
                      <Cell text="bind:seq" textAlign="center" displaytype="mask" maskeditformat="####"/>
                      <Cell col="1" text="bind:title" textAlign="center"/>
                      <Cell col="2" text="bind:final_date" textAlign="center" displaytype="calendarcontrol" autosizerow="limitmin" autosizecol="default"/>
                      <Cell col="3" text="bind:process" textAlign="center"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
            </Layout>
            <Layout name="default0">
              <Grid id="Grid00" taborder="0" left="1%" top="1%" width="99%" height="99%" binddataset="ds_document" autofittype="col"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="divDocument" taborder="3" text="Div01" border="1px solid #c9c9c9" formscrollbartype="none" formscrolltype="none" width="550" top="270" bottom="50" minheight="300" maxheight="" left="Div00:10">
          <Layouts>
            <Layout>
              <Static id="Static00" taborder="0" text="제목" top="65" height="35" width="80" left="20" border="0px none,1px solid #c9c9c9,1px solid #c9c9c9,0px none" padding="0px 0px 0px 5px"/>
              <Static id="Static00_00" taborder="1" text="내용" top="170" width="80" left="20" border="0px none,1px solid #c9c9c9,1px solid #c9c9c9,0px none" bottom="10" padding="0px 0px 0px 5px"/>
              <TextArea id="TextArea00" taborder="2" left="110" top="175" right="25" enable="false" bottom="15" maxheight=""/>
              <Static id="Static00_01" taborder="3" text="승인날짜" left="300" top="30" width="80" height="35" border="1px solid #c9c9c9,1px solid #c9c9c9,1px solid #c9c9c9,0px none" padding="0px 0px 0px 5px"/>
              <Static id="Static00_01_00" taborder="4" text="종류" left="20" top="100" width="80" height="35" border="0px none,1px solid #c9c9c9,1px solid #c9c9c9,0px none" padding="0px 0px 0px 5px"/>
              <Static id="Static00_02" taborder="5" text="문서번호" left="105" top="30" width="120" height="30"/>
              <Static id="Static00_01_01" taborder="6" text="시작 날짜" left="20" top="135" width="80" height="35" border="0px none,1px solid #c9c9c9,1px solid #c9c9c9,0px none" padding="0px 0px 0px 5px"/>
              <Static id="Static00_01_02" taborder="7" text="마감 날짜" left="300" top="135" width="80" height="35" border="0px none,1px solid #c9c9c9,1px solid #c9c9c9" padding="0px 0px 0px 5px"/>
              <Static id="Static00_01_00_00" taborder="8" text="작성자" left="300" top="100" width="80" height="35" border="0px none,1px solid #c9c9c9,1px solid #c9c9c9" padding="0px 0px 0px 5px"/>
              <Static id="Static00_02_00" taborder="9" text="휴가 신청서" left="0" top="0" height="20" cssclass="sta_WF_title01" right="172"/>
              <Static id="Static00_03" taborder="10" text="문서번호" top="30" height="35" width="80" left="20" border="1px solid #c9c9c9,1px solid #c9c9c9,1px solid #c9c9c9,0px none" padding="0px 0px 0px 5px"/>
              <Static id="staticSeq" taborder="11" top="30" height="35" width="200" left="100" border="1px solid #c9c9c9,1px solid #c9c9c9,1px solid #c9c9c9,0px none" text=""/>
              <Static id="Static00_01_03" taborder="12" left="380" top="30" height="35" right="20" border="1px solid #c9c9c9,0px none,1px solid #c9c9c9,"/>
              <Static id="Static00_04" taborder="13" top="65" height="35" left="100" right="20" border="0px none,0px none,1px solid #c9c9c9" onclick="Div01_Static00_04_onclick"/>
              <Static id="Static00_01_00_01" taborder="14" left="100" top="100" width="200" height="35" border="0px none,0px none,1px solid #c9c9c9"/>
              <Static id="Static00_01_00_01_00" taborder="15" left="380" top="100" height="35" border="0px none,0px none,1px solid #c9c9c9" right="20"/>
              <Static id="Static00_01_00_01_00_00" taborder="16" left="380" top="135" height="35" border="0px none,0px none,1px solid #c9c9c9" right="20"/>
              <Static id="Static00_01_00_01_00_00_00" taborder="17" left="100" top="135" width="200" height="35" border="0px none,0px none,1px solid #c9c9c9"/>
              <Static id="Static00_00_00" taborder="18" top="170" left="100" bottom="10" right="20" border="0px none,0px none,1px solid #c9c9c9"/>
              <Static id="staticWriter" taborder="19" text="writer" left="385" top="102" width="195" height="30"/>
              <Static id="staticTitle" taborder="20" text="Static02" left="105" top="67" width="196" height="29"/>
              <MaskEdit id="maskStartDate" taborder="21" left="109" top="137" width="120" height="30" border="none" format="#### - ## - ##" type="string" enable="false" background="#ffffff" color="#000000" onchanged="divDocument_maskStartDate_onchanged"/>
              <MaskEdit id="maskEndDate" taborder="22" left="385" top="137" width="120" height="30" border="none" format="#### - ## - ##" type="string" enable="false" background="#ffffff" color="#000000"/>
              <MaskEdit id="MaskEdit00_00_00" taborder="23" left="385" top="32" width="120" height="30" border="none" format="#### - ## - ##" type="string" enable="false" background="#ffffff" color="#000000"/>
              <Static id="staticType" taborder="24" text="Static02" left="105" top="102" width="195" height="30"/>
            </Layout>
            <Layout name="default0">
              <Static id="Static00" taborder="0" text="제목" left="285" top="19" width="40" height="30"/>
              <Static id="Static00_00" taborder="1" text="내용" left="285" top="58" width="40" height="30"/>
              <TextArea id="TextArea00" taborder="2" left="335" top="59" width="300" height="220"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="divProcess" taborder="2" text="Div02" top="100" height="160" border="1px solid #c9c9c9" formscrollbartype="none" formscrolltype="none" left="Div00:10" width="550">
          <Layouts>
            <Layout>
              <Static id="seq" taborder="0" text="문서번호" left="105" top="30" height="30" border="1px solid #c9c9c9c,0px none,0px none" width="100"/>
              <Static id="Static01" taborder="1" text="종류" left="20" top="60" width="80" height="30" padding="0px 0px 0px 5px" border="0px none,1px solid #c9c9c9,1px solid #c9c9c9,0px none"/>
              <Static id="Static01_00" taborder="2" text="시간" left="20" top="90" width="80" height="30" border="0px none,1px solid #c9c9c9,1px solid #c9c9c9,0px none" padding="0px 0px 0px 5px"/>
              <Edit id="editType" taborder="3" left="105" top="62" height="25" enable="false" width="150"/>
              <Static id="Static00" taborder="4" top="60" width="200" height="30" left="80" border="0px none,0px none,1px solid #c9c9c9"/>
              <Static id="Static00_00" taborder="5" top="90" width="200" height="30" left="80" border="0px none,0px none,1px solid #c9c9c9," padding="0px 0px 0px 5px" onclick="Div02_Static00_00_onclick" text=""/>
              <Static id="Static00_01" taborder="6" top="60" height="30" left="370" right="20" border="0px none,0px none,1px solid #c7c7c7"/>
              <Static id="Static00_00_00" taborder="7" top="90" height="30" border="0px none,0px none,1px solid #c9c9c9," padding="0px 0px 0px 5px" left="370" right="20"/>
              <Static id="Static01_01" taborder="8" text="시작 날짜" left="280" top="60" width="90" height="30" padding="0px 0px 0px 5px" border="0px none,1px solid #c7c7c7,1px solid #c7c7c7"/>
              <Static id="Static01_00_00" taborder="9" text="마감 날짜" left="280" top="90" width="90" height="30" border="0px none,1px solid #c9c9c9,1px solid #c9c9c9,1px solid #c7c7c7" padding="0px 0px 0px 5px"/>
              <Button id="submitBtn00" taborder="10" text="등록" top="-42" height="25" background="linear-gradient(#23cccc,#1098d5)" borderRadius="10px" right="-0.97%" width="69" color="#ffffff" onclick="Div02_submitBtn_onclick"/>
              <Static id="Static00_02" taborder="11" text="휴가 사용 처리" left="0" top="0" height="20" cssclass="sta_WF_title01" right="172" onclick="divProcess_Static00_02_onclick"/>
              <Static id="Static01_02" taborder="12" text="문서번호" left="20" top="30" width="80" height="30" padding="0px 0px 0px 5px" border="1px solid #c9c9c9,1px solid #c9c9c9,1px solid #c9c9c9,0px none"/>
              <Static id="Static00_01_00" taborder="13" top="30" height="30" border="1px solid #c7c7c7,0px none" left="100" right="20"/>
              <Spin id="spinTime" taborder="14" left="105" top="92" width="150" height="25" max="7" min="1"/>
              <Calendar id="calStart" taborder="15" left="377" top="64" width="130" height="24"/>
              <Calendar id="calEnd" taborder="16" left="377" top="92" width="130" height="25"/>
              <CheckBox id="checkMinus" taborder="17" text="휴가차감여부" left="25" top="125" width="150" height="25"/>
            </Layout>
            <Layout name="default0"/>
          </Layouts>
        </Div>
        <Div id="divBtn" taborder="4" text="Div01" top="50" height="30" right="100" minwidth="990" maxwidth="" left="20">
          <Layouts>
            <Layout>
              <Button id="submitBtn" taborder="0" text="추가" top="0" width="60" height="30" onclick="Div02_submitBtn_onclick" cssclass="btn_WF_add01" right="0"/>
            </Layout>
            <Layout name="default0"/>
          </Layouts>
        </Div>
      </Layout>
      <Layout height="650" width="1090" name="default0">
        <Static id="Static00" taborder="0" text="휴가 부여" left="0" top="0" height="34" cssclass="sta_WF_title01" right="10"/>
        <Div id="Div00" taborder="2" text="Div00" left="2%" top="100" width="35%" height="500" border="1px solid black"/>
        <Div id="divDocument" taborder="1" text="Div01" left="39%" top="100" height="300" border="1px solid black" right="2%"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_document" onrowposchanged="ds_document_onrowposchanged">
        <ColumnInfo>
          <Column id="seq" type="INT" size="256"/>
          <Column id="title" type="STRING" size="256"/>
          <Column id="contents" type="STRING" size="256"/>
          <Column id="write_date" type="DATETIME" size="256"/>
          <Column id="final_date" type="DATETIME" size="256"/>
          <Column id="writer_code" type="INT" size="256"/>
          <Column id="dept_code" type="INT" size="256"/>
          <Column id="temp_code" type="INT" size="256"/>
          <Column id="leave_start" type="DATE" size="256"/>
          <Column id="leave_end" type="DATE" size="256"/>
          <Column id="leave_type" type="STRING" size="256"/>
          <Column id="status" type="STRING" size="256"/>
          <Column id="process" type="STRING" size="256"/>
          <Column id="name" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="seq">1001</Col>
            <Col id="title">조퇴</Col>
            <Col id="contents">3시에 먼저 갑니다</Col>
            <Col id="write_date">2021-02-16</Col>
            <Col id="final_date">2021-02-16</Col>
            <Col id="writer_code">1004</Col>
            <Col id="leave_start">2021-02-16</Col>
            <Col id="leave_end"/>
            <Col id="leave_type">조퇴</Col>
            <Col id="status">CONFIRM</Col>
            <Col id="process">N</Col>
          </Row>
          <Row>
            <Col id="seq">1002</Col>
            <Col id="title">기타</Col>
            <Col id="contents">일주일만 쉴게여</Col>
            <Col id="write_date">2021-02-17</Col>
            <Col id="final_date">2021-02-17</Col>
            <Col id="writer_code">1004</Col>
            <Col id="leave_start">2021-02-20</Col>
            <Col id="leave_end">2021-02-27</Col>
            <Col id="leave_type">기타</Col>
            <Col id="status">CONFIRM</Col>
            <Col id="process">Y</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Script type="xscript5.1"><![CDATA[

this.M31_grantVacation_onload = function(obj:nexacro.Form,e:nexacro.LoadEventInfo)
{
	this.transaction(
			"documentList", // 1. strSvcID
			"/documentN/getEarlyList.documentN", // 2. strURL
			"", // 3. strIndatasets - Insert,Delete,Update  Sds = Fds :U ,:A ,:N
			"ds_document=out_document", // 4. strOutDatasets -select Fds=Sds
			"" , // 5. strArgument 화면에서 서버로 보내는 변수값 (구분자는 띄어쓰기로' ')
			"" // 6. strCallbackFunc
		);
};

this.Div02_submitBtn_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var seq = this.divProcess.form.seq.text;
	var type = this.divProcess.form.editType.value;
	var startDate = this.divProcess.form.calStart.value;
	var endDate = this.divProcess.form.calEnd.value;
	var time = this.divProcess.form.spinTime.value;
	var empCode = this.ds_document.getColumn(this.ds_document.rowposition, "writer_code");
	var check = this.divProcess.form.checkMinus.value;
	
	
	//ds_document 가져오기
	this.transaction(
			"insertLeave", // 1. strSvcID
			"/leaveN/insert.leaveN", // 2. strURL
			"", // 3. strIndatasets - Insert,Delete,Update  Sds = Fds :U ,:A ,:N
			"", // 4. strOutDatasets -select Fds=Sds
			"seq=" +seq + " type=" + type + " startDate=" + startDate + " endDate=" + endDate + " time=" + time + " empCode=" + empCode + " check=" + check, // 5. strArgument 화면에서 서버로 보내는 변수값 (구분자는 띄어쓰기로' ')
			"fn_callback" // 6. strCallbackFunc
		);
};

this.fn_callback = function(id, ErrCode, ErrMsg)
{
	trace(ErrMsg);
	this.M31_grantVacation_onload();
}
this.ds_document_onrowposchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSRowPosChangeEventInfo)
{	
	//처리상태 Y일때 처리 못하게 막기
	var process = this.ds_document.getColumn(e.newrow, "process");
	if(process == "Y"){
		this.divProcess.form.spinTime.set_enable(false);
		this.divProcess.form.calStart.set_enable(false);
		this.divProcess.form.calEnd.set_enable(false);
		this.divProcess.form.checkMinus.set_enable(false);
		this.divBtn.form.submitBtn.set_enable(false);
	}else {//미처리 문서 클릭 시
		this.divBtn.form.submitBtn.set_enable(true);
		//조퇴인지 기타인지에 따라 입력가능창 바꿔주기
		var type = this.ds_document.getColumn(e.newrow, "leave_type");
		if (type == "조퇴"){
			this.divProcess.form.spinTime.set_enable(true);
			this.divProcess.form.calStart.set_enable(false);
			this.divProcess.form.calEnd.set_enable(false);
			this.divProcess.form.checkMinus.set_enable(false);
		}else if (type == "기타"){
			this.divProcess.form.spinTime.set_enable(false);
			this.divProcess.form.calStart.set_enable(true);
			this.divProcess.form.calEnd.set_enable(true);
			this.divProcess.form.checkMinus.set_enable(true);
		}
	}
	
};
]]></Script>
    <Bind>
      <BindItem id="item0" compid="divDocument.form.Static00_02" propid="text" datasetid="ds_document" columnid="seq"/>
      <BindItem id="item9" compid="divProcess.form.seq" propid="text" datasetid="ds_document" columnid="seq"/>
      <BindItem id="item11" compid="divProcess.form.editType" propid="value" datasetid="ds_document" columnid="leave_type"/>
      <BindItem id="item2" compid="divDocument.form.TextArea00" propid="value" datasetid="ds_document" columnid="contents"/>
      <BindItem id="item14" compid="divDocument.form.staticTitle" propid="text" datasetid="ds_document" columnid="title"/>
      <BindItem id="item16" compid="divDocument.form.maskStartDate" propid="value" datasetid="ds_document" columnid="leave_start"/>
      <BindItem id="item1" compid="divDocument.form.MaskEdit00_00_00" propid="value" datasetid="ds_document" columnid="final_date"/>
      <BindItem id="item4" compid="divDocument.form.staticType" propid="text" datasetid="ds_document" columnid="leave_type"/>
      <BindItem id="item5" compid="divDocument.form.staticWriter" propid="text" datasetid="ds_document" columnid="name"/>
      <BindItem id="item6" compid="divProcess.form.calStart" propid="value" datasetid="ds_document" columnid="leave_start"/>
      <BindItem id="item3" compid="divProcess.form.calEnd" propid="value" datasetid="ds_document" columnid="leave_end"/>
      <BindItem id="item7" compid="divDocument.form.maskEndDate" propid="value" datasetid="ds_document" columnid="leave_end"/>
    </Bind>
  </Form>
</FDL>
